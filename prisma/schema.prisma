generator client {
    provider = "prisma-client"
    output   = "../generated/prisma"
}

datasource db {
    provider = "postgresql"
}

//* Type - PostVisibility
enum PostVisibility {
    PRIVATE
    PUBLIC
}

//* Type - PostStatus
enum PostStatus {
    PENDING_REVIEW
    APPROVED
    REJECTED
}

//* Type - ReactionType
enum ReactionType {
    POSITIVE
    NEGATIVE
}

//* Type - NotificationType
enum NotificationType {
    ANNOUNCEMENT
    REVIEW_REQUEST
    POST_REVIEW
    POST_REACTION
    POST_COMMENT
    COMMENT_REACTION
    COMMENT_REPLY
}

//* Type - NotificationSubjectType
enum NotificationSubjectType {
    PLATFORM
    POST
    COMMENT
}

//* Type - ProfileGender
enum ProfileGender {
    MALE
    FEMALE
    LGBTQ_PLUS
}

//* Type - ProfilePronouns
enum ProfilePronouns {
    HE_HIM
    SHE_HER
    THEY_THEM
}

//* Model - Profile
model Profile {
    id          String          @id @default(uuid()) @db.Uuid
    userId      String          @unique @map("user_id") @db.Uuid
    displayName String          @map("display_name") @db.VarChar(50)
    phone       String?         @db.VarChar(17)
    bio         String?         @db.VarChar(200)
    isVerified  Boolean         @default(false) @map("is_verified")
    picture     String
    banner      String?
    gender      ProfileGender
    pronouns    ProfilePronouns
    website     String?
    facebook    String?
    linkedin    String?
    xTwitter    String?         @map("x_twitter")
    instagram   String?
    github      String?
    updatedAt   DateTime        @updatedAt @map("updated_at")
}

//* Model - Post
model Post {
    id                String         @id @default(uuid()) @db.Uuid
    authorId          String         @map("author_id") @db.Uuid
    thumbnail         String?
    title             String         @db.VarChar(100)
    content           String?
    tags              String[]       @default([])
    visibility        PostVisibility @default(PUBLIC)
    readTime          String         @map("read_time") @db.VarChar(7)
    views             Int            @default(0)
    isFeatured        Boolean        @default(false) @map("is_featured")
    reviewRequestedAt DateTime       @default(now()) @map("review_requested_at")
    reviewedAt        DateTime?      @map("reviewed_at")
    updatedAt         DateTime       @updatedAt @map("updated_at")
    status            PostStatus     @default(PENDING_REVIEW)
    reactions         Reaction[]
    comments          Comment[]
}

//* Model - Reaction
model Reaction {
    id        String       @id @default(uuid()) @db.Uuid
    userId    String       @map("user_id") @db.Uuid
    postId    String?      @map("post_id") @db.Uuid
    post      Post?        @relation(fields: [postId], references: [id])
    commentId String?      @map("comment_id") @db.Uuid
    comment   Comment?     @relation(fields: [commentId], references: [id])
    type      ReactionType
    reactedAt DateTime     @default(now()) @map("reacted_at")
}

//* Model - Comment
model Comment {
    id        String     @id @default(uuid()) @db.Uuid
    userId    String     @map("user_id") @db.Uuid
    postId    String     @map("post_id") @db.Uuid
    post      Post       @relation(fields: [postId], references: [id])
    parentId  String?    @map("parent_id") @db.Uuid
    parent    Comment?   @relation(name: "CommentReplies", fields: [parentId], references: [id])
    content   String
    createdAt DateTime   @default(now()) @map("created_at")
    updatedAt DateTime   @updatedAt @map("updated_at")
    reactions Reaction[]
    replies   Comment[]  @relation(name: "CommentReplies")
}

//! Future-planned Model
//* Model - Notification
/**
 * model Notification {
 * id           String                  @id @default(uuid()) @db.Uuid
 * receiver_id  String                  @db.Uuid
 * sender_id    String                  @db.Uuid
 * subject_id   String                  @db.Uuid
 * type         NotificationType
 * subject_type NotificationSubjectType
 * has_seen     Boolean                 @default(false)
 * created_at   DateTime                @default(now())
 * }
 */
